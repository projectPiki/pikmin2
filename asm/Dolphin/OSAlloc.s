.include "macros.inc"
.section .sdata, "wa"  # 0x80514680 - 0x80514D80
.balign 8
.global __OSCurrHeap
__OSCurrHeap:
	.4byte 0xFFFFFFFF

.section .sbss # 0x80514D80 - 0x80516360
.balign 8
.global HeapArray
HeapArray:
	.skip 0x4
.global NumHeaps
NumHeaps:
	.skip 0x4
.global ArenaStart
ArenaStart:
	.skip 0x4
.global ArenaEnd
ArenaEnd:
	.skip 0x4

.section .text, "ax"  # 0x800056C0 - 0x80472F00
.global DLInsert
DLInsert:
/* 800EC210 000E9150  38 E3 00 00 */	addi r7, r3, 0
/* 800EC214 000E9154  38 C0 00 00 */	li r6, 0
/* 800EC218 000E9158  48 00 00 14 */	b lbl_800EC22C
lbl_800EC21C:
/* 800EC21C 000E915C  7C 04 38 40 */	cmplw r4, r7
/* 800EC220 000E9160  40 81 00 14 */	ble lbl_800EC234
/* 800EC224 000E9164  7C E6 3B 78 */	mr r6, r7
/* 800EC228 000E9168  80 E7 00 04 */	lwz r7, 4(r7)
lbl_800EC22C:
/* 800EC22C 000E916C  28 07 00 00 */	cmplwi r7, 0
/* 800EC230 000E9170  40 82 FF EC */	bne lbl_800EC21C
lbl_800EC234:
/* 800EC234 000E9174  90 E4 00 04 */	stw r7, 4(r4)
/* 800EC238 000E9178  28 07 00 00 */	cmplwi r7, 0
/* 800EC23C 000E917C  90 C4 00 00 */	stw r6, 0(r4)
/* 800EC240 000E9180  41 82 00 38 */	beq lbl_800EC278
/* 800EC244 000E9184  90 87 00 00 */	stw r4, 0(r7)
/* 800EC248 000E9188  80 A4 00 08 */	lwz r5, 8(r4)
/* 800EC24C 000E918C  7C 04 2A 14 */	add r0, r4, r5
/* 800EC250 000E9190  7C 00 38 40 */	cmplw r0, r7
/* 800EC254 000E9194  40 82 00 24 */	bne lbl_800EC278
/* 800EC258 000E9198  80 07 00 08 */	lwz r0, 8(r7)
/* 800EC25C 000E919C  7C 05 02 14 */	add r0, r5, r0
/* 800EC260 000E91A0  90 04 00 08 */	stw r0, 8(r4)
/* 800EC264 000E91A4  80 E7 00 04 */	lwz r7, 4(r7)
/* 800EC268 000E91A8  28 07 00 00 */	cmplwi r7, 0
/* 800EC26C 000E91AC  90 E4 00 04 */	stw r7, 4(r4)
/* 800EC270 000E91B0  41 82 00 08 */	beq lbl_800EC278
/* 800EC274 000E91B4  90 87 00 00 */	stw r4, 0(r7)
lbl_800EC278:
/* 800EC278 000E91B8  28 06 00 00 */	cmplwi r6, 0
/* 800EC27C 000E91BC  41 82 00 38 */	beq lbl_800EC2B4
/* 800EC280 000E91C0  90 86 00 04 */	stw r4, 4(r6)
/* 800EC284 000E91C4  80 A6 00 08 */	lwz r5, 8(r6)
/* 800EC288 000E91C8  7C 06 2A 14 */	add r0, r6, r5
/* 800EC28C 000E91CC  7C 00 20 40 */	cmplw r0, r4
/* 800EC290 000E91D0  4C 82 00 20 */	bnelr 
/* 800EC294 000E91D4  80 04 00 08 */	lwz r0, 8(r4)
/* 800EC298 000E91D8  28 07 00 00 */	cmplwi r7, 0
/* 800EC29C 000E91DC  7C 05 02 14 */	add r0, r5, r0
/* 800EC2A0 000E91E0  90 06 00 08 */	stw r0, 8(r6)
/* 800EC2A4 000E91E4  90 E6 00 04 */	stw r7, 4(r6)
/* 800EC2A8 000E91E8  4D 82 00 20 */	beqlr 
/* 800EC2AC 000E91EC  90 C7 00 00 */	stw r6, 0(r7)
/* 800EC2B0 000E91F0  4E 80 00 20 */	blr 
lbl_800EC2B4:
/* 800EC2B4 000E91F4  7C 83 23 78 */	mr r3, r4
/* 800EC2B8 000E91F8  4E 80 00 20 */	blr 

.global OSFreeToHeap
OSFreeToHeap:
/* 800EC2BC 000E91FC  7C 08 02 A6 */	mflr r0
/* 800EC2C0 000E9200  38 C4 FF E0 */	addi r6, r4, -32
/* 800EC2C4 000E9204  90 01 00 04 */	stw r0, 4(r1)
/* 800EC2C8 000E9208  1C 03 00 0C */	mulli r0, r3, 0xc
/* 800EC2CC 000E920C  94 21 FF E8 */	stwu r1, -0x18(r1)
/* 800EC2D0 000E9210  93 E1 00 14 */	stw r31, 0x14(r1)
/* 800EC2D4 000E9214  80 8D 8F 58 */	lwz r4, HeapArray@sda21(r13)
/* 800EC2D8 000E9218  80 66 00 04 */	lwz r3, 4(r6)
/* 800EC2DC 000E921C  7F E4 02 14 */	add r31, r4, r0
/* 800EC2E0 000E9220  28 03 00 00 */	cmplwi r3, 0
/* 800EC2E4 000E9224  80 BF 00 08 */	lwz r5, 8(r31)
/* 800EC2E8 000E9228  7C C4 33 78 */	mr r4, r6
/* 800EC2EC 000E922C  41 82 00 0C */	beq lbl_800EC2F8
/* 800EC2F0 000E9230  80 04 00 00 */	lwz r0, 0(r4)
/* 800EC2F4 000E9234  90 03 00 00 */	stw r0, 0(r3)
lbl_800EC2F8:
/* 800EC2F8 000E9238  80 64 00 00 */	lwz r3, 0(r4)
/* 800EC2FC 000E923C  28 03 00 00 */	cmplwi r3, 0
/* 800EC300 000E9240  40 82 00 0C */	bne lbl_800EC30C
/* 800EC304 000E9244  80 A4 00 04 */	lwz r5, 4(r4)
/* 800EC308 000E9248  48 00 00 0C */	b lbl_800EC314
lbl_800EC30C:
/* 800EC30C 000E924C  80 04 00 04 */	lwz r0, 4(r4)
/* 800EC310 000E9250  90 03 00 04 */	stw r0, 4(r3)
lbl_800EC314:
/* 800EC314 000E9254  90 BF 00 08 */	stw r5, 8(r31)
/* 800EC318 000E9258  80 7F 00 04 */	lwz r3, 4(r31)
/* 800EC31C 000E925C  4B FF FE F5 */	bl DLInsert
/* 800EC320 000E9260  90 7F 00 04 */	stw r3, 4(r31)
/* 800EC324 000E9264  80 01 00 1C */	lwz r0, 0x1c(r1)
/* 800EC328 000E9268  83 E1 00 14 */	lwz r31, 0x14(r1)
/* 800EC32C 000E926C  38 21 00 18 */	addi r1, r1, 0x18
/* 800EC330 000E9270  7C 08 03 A6 */	mtlr r0
/* 800EC334 000E9274  4E 80 00 20 */	blr 

.global OSSetCurrentHeap
OSSetCurrentHeap:
/* 800EC338 000E9278  80 0D 83 58 */	lwz r0, __OSCurrHeap@sda21(r13)
/* 800EC33C 000E927C  90 6D 83 58 */	stw r3, __OSCurrHeap@sda21(r13)
/* 800EC340 000E9280  7C 03 03 78 */	mr r3, r0
/* 800EC344 000E9284  4E 80 00 20 */	blr 

.global OSInitAlloc
OSInitAlloc:
/* 800EC348 000E9288  1C E5 00 0C */	mulli r7, r5, 0xc
/* 800EC34C 000E928C  90 6D 8F 58 */	stw r3, HeapArray@sda21(r13)
/* 800EC350 000E9290  90 AD 8F 5C */	stw r5, NumHeaps@sda21(r13)
/* 800EC354 000E9294  38 C0 00 00 */	li r6, 0
/* 800EC358 000E9298  38 66 00 00 */	addi r3, r6, 0
/* 800EC35C 000E929C  39 00 00 00 */	li r8, 0
/* 800EC360 000E92A0  38 A0 FF FF */	li r5, -1
/* 800EC364 000E92A4  48 00 00 20 */	b lbl_800EC384
lbl_800EC368:
/* 800EC368 000E92A8  80 0D 8F 58 */	lwz r0, HeapArray@sda21(r13)
/* 800EC36C 000E92AC  39 08 00 01 */	addi r8, r8, 1
/* 800EC370 000E92B0  7D 20 32 14 */	add r9, r0, r6
/* 800EC374 000E92B4  90 A9 00 00 */	stw r5, 0(r9)
/* 800EC378 000E92B8  38 C6 00 0C */	addi r6, r6, 0xc
/* 800EC37C 000E92BC  90 69 00 08 */	stw r3, 8(r9)
/* 800EC380 000E92C0  90 69 00 04 */	stw r3, 4(r9)
lbl_800EC384:
/* 800EC384 000E92C4  80 0D 8F 5C */	lwz r0, NumHeaps@sda21(r13)
/* 800EC388 000E92C8  7C 08 00 00 */	cmpw r8, r0
/* 800EC38C 000E92CC  41 80 FF DC */	blt lbl_800EC368
/* 800EC390 000E92D0  80 6D 8F 58 */	lwz r3, HeapArray@sda21(r13)
/* 800EC394 000E92D4  54 80 00 34 */	rlwinm r0, r4, 0, 0, 0x1a
/* 800EC398 000E92D8  38 80 FF FF */	li r4, -1
/* 800EC39C 000E92DC  90 0D 8F 64 */	stw r0, ArenaEnd@sda21(r13)
/* 800EC3A0 000E92E0  7C 63 3A 14 */	add r3, r3, r7
/* 800EC3A4 000E92E4  38 03 00 1F */	addi r0, r3, 0x1f
/* 800EC3A8 000E92E8  90 8D 83 58 */	stw r4, __OSCurrHeap@sda21(r13)
/* 800EC3AC 000E92EC  54 03 00 34 */	rlwinm r3, r0, 0, 0, 0x1a
/* 800EC3B0 000E92F0  90 6D 8F 60 */	stw r3, ArenaStart@sda21(r13)
/* 800EC3B4 000E92F4  4E 80 00 20 */	blr 

.global OSCreateHeap
OSCreateHeap:
/* 800EC3B8 000E92F8  80 CD 8F 5C */	lwz r6, NumHeaps@sda21(r13)
/* 800EC3BC 000E92FC  38 03 00 1F */	addi r0, r3, 0x1f
/* 800EC3C0 000E9300  80 AD 8F 58 */	lwz r5, HeapArray@sda21(r13)
/* 800EC3C4 000E9304  54 07 00 34 */	rlwinm r7, r0, 0, 0, 0x1a
/* 800EC3C8 000E9308  2C 06 00 00 */	cmpwi r6, 0
/* 800EC3CC 000E930C  7C C9 03 A6 */	mtctr r6
/* 800EC3D0 000E9310  54 84 00 34 */	rlwinm r4, r4, 0, 0, 0x1a
/* 800EC3D4 000E9314  38 60 00 00 */	li r3, 0
/* 800EC3D8 000E9318  40 81 00 44 */	ble lbl_800EC41C
lbl_800EC3DC:
/* 800EC3DC 000E931C  80 05 00 00 */	lwz r0, 0(r5)
/* 800EC3E0 000E9320  2C 00 00 00 */	cmpwi r0, 0
/* 800EC3E4 000E9324  40 80 00 2C */	bge lbl_800EC410
/* 800EC3E8 000E9328  7C 07 20 50 */	subf r0, r7, r4
/* 800EC3EC 000E932C  90 05 00 00 */	stw r0, 0(r5)
/* 800EC3F0 000E9330  38 80 00 00 */	li r4, 0
/* 800EC3F4 000E9334  90 87 00 00 */	stw r4, 0(r7)
/* 800EC3F8 000E9338  90 87 00 04 */	stw r4, 4(r7)
/* 800EC3FC 000E933C  80 05 00 00 */	lwz r0, 0(r5)
/* 800EC400 000E9340  90 07 00 08 */	stw r0, 8(r7)
/* 800EC404 000E9344  90 E5 00 04 */	stw r7, 4(r5)
/* 800EC408 000E9348  90 85 00 08 */	stw r4, 8(r5)
/* 800EC40C 000E934C  4E 80 00 20 */	blr 
lbl_800EC410:
/* 800EC410 000E9350  38 A5 00 0C */	addi r5, r5, 0xc
/* 800EC414 000E9354  38 63 00 01 */	addi r3, r3, 1
/* 800EC418 000E9358  42 00 FF C4 */	bdnz lbl_800EC3DC
lbl_800EC41C:
/* 800EC41C 000E935C  38 60 FF FF */	li r3, -1
/* 800EC420 000E9360  4E 80 00 20 */	blr 
